
<style>
.videoitem{
	margin-top: 5px;
margin-left: -5px;
}

.videoInfo{
	border: 1px solid #CCC;
	width:100%;
	margin-top: 5px;
	margin-bottom: 5px;
	padding:5px;
}
.videoMain{
	margin-right: 1%;
	margin-bottom: 1%;
	width: 19%;
	border: 2px solid #ccc;
}
.videoMain div{
	float: left;
}
.centerbox{
	width: 100%;
}
</style>
<link href="__PUBLIC__/css/video-js.min.css" rel="stylesheet">
<script src="__PUBLIC__/js/video.min.js"></script>

   <!-- site specific styling -->




   <!-- include flowplayer -->


	<div class="breadcrumbs" id="breadcrumbs">
		<script type="text/javascript">
			try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}
		</script>

		<ul class="breadcrumb">
			<li>
				<i class="icon-home home-icon"></i>
				<a href="{:U('Index/index')}">首页</a>
			</li>
			<li class="active">统计</li>
		</ul>
	</div>

	<div class="page-content">
		<div class="page-header">
			<h1>
				统计中心
			</h1>
		</div><!-- /.page-header -->

		<div class="row">
			<div class="col-xs-12">
							<div id="home" class="tab-pane <if condition="$_GET['type'] eq hours">active</if>">
								<div class="row">
								<div class="col-xs-12 col-sm-12">
										<div class="widget-box">
											<div class="widget-header">
												<h4>搜索</h4>

												<span class="widget-toolbar">

													<a href="#" data-action="collapse">
														<i class="icon-chevron-up"></i>
													</a>

													<a href="#" data-action="close">
														<i class="icon-remove"></i>
													</a>
												</span>
											</div>

											<div class="widget-body">
												<div class="widget-main">
													<form class="form-inline" role="form" id="form-signin" action="{:U('System/total3')}" method="get">
														
														<div class="form-group">
															<select class="form-control" name="cat_id" id="form-field-select-1">
																	<option value="">全部部门</option>
																<volist name="cats" id="vo">
																	<option value="{$vo.cat_id}" <if condition="$vo['cat_id'] eq $_GET['cat_id']">selected="selected"</if>>{$vo.cat_name}</option>
																</volist>
															</select>
														</div>
														<div class="form-group">
															<select class="form-control" name="action_id" id="form-field-select-1">
																	<option value="">全部行为</option>
																<volist name="actions" id="vo">
																	<option value="{$vo.cat_id}" <if condition="$vo['cat_id'] eq $_GET['action_id']">selected="selected"</if>>{$vo.cat_name}</option>
																</volist>
															</select>
														</div>
														
														<div class="form-group">
															<label for="meeting">开始日期：</label><input name="start" type="date" value="{$_GET['start']}"/>
														</div>
														
														<div class="form-group">
															<label for="meeting">结束日期：</label><input name="over" type="date" value="{$_GET['over']}"/>
														</div>
														
														<button type="submit" class="btn btn-sm btn-warning">查找</button>
														
														<input type="button" style="float:right;" class="btn btn-sm btn-success" onclick="aa()" value="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;统&nbsp;&nbsp;计&nbsp;&nbsp;打&nbsp;&nbsp;印&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"/>
													</form>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col-xs-12">
									<div class="row">
									
									<div class="widget-header">
												<h4 style="color:red;">巡查结果</h4>

												<span class="widget-toolbar">

													<a href="#" data-action="collapse">
														<i class="icon-chevron-up"></i>
													</a>

													<a href="#" data-action="close">
														<i class="icon-remove"></i>
													</a>
												</span>
											</div>
											

									
									<div class="table-responsive">
							<table id="sample1" class="table table-striped table-bordered table-hover">
							
								<thead>
									<tr>
										<th>
										
										部门
										
										</th>
										<th>
										
										工作人员
										
										</th>
										<volist name="action" id="vo">
											<th>
											
											{$vo.cat_name}
											
											</th>
										</volist>
									</tr>
								</thead>
								
								<tbody>
									<tr>
										<!-- <td class="center">
											<label>
												<input type="checkbox" class="ace" />
												<span class="lbl"></span>
											</label>
										</td> -->
										<empty name="result">
											<td colspan="99" style="text-align:center" class="danger"> <strong><i class="fa fa-meh-o"></i>
													&nbsp;&nbsp;当前条件下没有数据</strong>
											</td>
											<else />
											<volist name="result" id="data">
													<tr>
													<td>{$data.cat_name}</td>
													<td>{$data.teacher_name}</td>
													<volist name="data['total']" id="vo2">
														<td <if condition="$vo2['cat_name'] neq '在岗' and $vo2['count'] neq 0">style="color:red;"</if>>
														<if condition="$vo2['count'] eq 0">
															
														<else/>
															<if condition="$vo2['cat_name'] eq '在岗'">
																<span class="badge badge-success ">{$vo2.count}</span>
															<elseif condition="$vo2['cat_name'] eq '公休' or $vo2['cat_name'] eq '事假' or $vo2['cat_name'] eq '病假'"/>
																<span class="badge badge-warning ">{$vo2.count}</span>
															<else/>
																<span class="badge badge-danger" style="background-color:red!important;">{$vo2.count}</span>
															</if>
														</if>
														
														
														</td>
													</volist>
													</tr>
												</volist>
										</empty>

					<tr>
							<td colspan="99" style="text-align:center">
									<ul class="pagination">{$pageView}</ul>
							</td>
					</tr>


				</tbody>
			</table>
			
			
		</div><!-- /.table-responsive -->
								</div>
								




							</div>
							
							
							
							
							
							
							
							
							
							
							


							</div>
						</div>
					</div>


</div>
<script language="javascript" src="__PUBLIC__/js/jq1.0.js"></script>
<script language="javascript" src="__PUBLIC__/js/jqprint.js"></script>
<script language="javascript">

function aa(){
	$("#sample1").jqprint();
}
</script>


	<script>
		$(".add-btn").click(function(){

			if($(".sh-btn").prop("checked")){

				var id = $(this).attr("data-id");
				var obj = $(this);
				$.ajax({
						type: "POST",
						url: '{:U("Topic/delVideo")}',
						data: {
								key:id
						},
						dataType: "json",
						success: function(data) {
								layer.msg(data.msg, {icon: 1});
								setTimeout(function(){window.location.reload();},1000);
						}
				});


			}else{

				var video_id   = $(this).attr("data-id");
				var video_name = $(this).attr("data-name");
				var topic_id = '{$_GET['id']}';

				$.ajax({
						type: "POST",
						url: '{:U("Topic/addVideo")}',
						data: {
								video_id:video_id,name: video_name,topic_id:topic_id
						},
						dataType: "json",
						success: function(data) {
								if(data.state==100){
										layer.msg(data.msg, {icon: 1});
										var str = "<div class='btn-group'><button type='button' class='btn btn-info cor1' data-id="+video_id+" disabled>" +video_name+ "</button><button type='button' class='btn btn-danger cordel' data-id="+video_id+">清除</button></div>";
										$('.bt-video').append(str);
										setTimeout(function(){window.location.reload();},1000);

								}else{
										layer.msg(data.msg, {icon: 2});
								}
						}
				});


			}

		});


		$(document).on("click",".check-table",function(){
			
			var tv = $(this).attr('data-id');
			var url = '__ACTION__';
			if(tv=='hours'){
				var bb = url + '/type/hours';
			}else{
				var bb = url + '/type/day';
			}
			var new_url = bb;
			 window.location.href = new_url;
			// alert(new_url);
		});

		$(document).on("click",".cordel",function(){
        var id = $(this).attr("data-id");
        var obj = $(this);

        $.ajax({
            type: "POST",
            url: '{:U("Topic/delVideo")}',
            data: {
                key:id
            },
            dataType: "json",
            success: function(data) {
                layer.msg(data.msg, {icon: 1});
                obj.parent().remove();

            }
        });
    });


		$(".del-it").click(function(){
			var obj = $(this);
			var video_id = $(this).attr("data-id");
			var topic_id = '{$_GET['id']}';

			layer.confirm('确定要将该视频移出本话题？', {
			  btn: ['移除','不了'] //按钮
			}, function(){
				$.ajax({
            type: "POST",
            url: '{:U("Topic/delTheVideo")}',
            data: {
                video_id:video_id,topic_id:topic_id
            },
            dataType: "json",
            success: function(data) {
							if(data.state==100){
								obj.parent().parent().remove();
								layer.msg(data.msg, {icon: 1});
								//setTimeout(function(){window.location.reload();},2000);
							}else{
								layer.msg(data.msg, {icon: 2});
							}
            }
        });
			}, function(){
				layer.msg('已取消操作', {icon: 1});
			});
		});


		$(".add-it").click(function(){
			var obj = $(this);
			var video_id = $(this).attr("data-id");
			var topic_id = '{$_GET['id']}';

				$.ajax({
						type: "POST",
						url: '{:U("Topic/addTheVideo")}',
						data: {
								video_id:video_id,topic_id:topic_id
						},
						dataType: "json",
						success: function(data) {
							if(data.state==100){
								obj.parent().parent().remove();
								layer.msg(data.msg, {icon: 1});
								//setTimeout(function(){window.location.reload();},2000);
							}else{
								layer.msg(data.msg, {icon: 2});
							}
						}
				});

		});

		$("#joinTopic").click(function(){
			var topic_id = $(this).attr('data-id');
			$.ajax({
					type: "POST",
					url: '{:U("Topic/joinTopic")}',
					data: {
							topic_id:topic_id
					},
					dataType: "json",
					success: function(data) {
						if(data.state == 100){
							layer.msg(data.msg, {icon: 1});
							setTimeout(function(){window.location.reload();},2000);
						}else{
							layer.msg(data.msg, {icon: 2});
						}

					}
			});

		});
		
		
		
		
		


	</script>
